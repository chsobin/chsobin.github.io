<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>Hibernate学习笔记 | chsobin&#39;s blog | coding</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Java">
    <meta name="description" content="是什么 Hibernate是一种ORM(Object Relational Mapping ）框架 它对JDBC进行了非常轻量级的对象封装  hibernate可以自动生成SQL语句，自动执行，使得Java程序员可以随心所欲的使用对象编程思维来操纵数据库">
<meta name="keywords" content="Java">
<meta property="og:type" content="article">
<meta property="og:title" content="Hibernate学习笔记">
<meta property="og:url" content="https://chsobin.github.io/2019/04/01/Hibernate学习笔记/index.html">
<meta property="og:site_name" content="chsobin&#39;s blog">
<meta property="og:description" content="是什么 Hibernate是一种ORM(Object Relational Mapping ）框架 它对JDBC进行了非常轻量级的对象封装  hibernate可以自动生成SQL语句，自动执行，使得Java程序员可以随心所欲的使用对象编程思维来操纵数据库">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://chsobin.github.io/2019/04/01/Hibernate学习笔记/log4j.png">
<meta property="og:image" content="https://chsobin.github.io/2019/04/01/Hibernate学习笔记/Hiberbate持久化类三种状态转换图.gif">
<meta property="og:image" content="https://chsobin.github.io/2019/04/01/Hibernate学习笔记/hibernate_cache.jpg">
<meta property="og:updated_time" content="2019-04-01T18:28:57.053Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hibernate学习笔记">
<meta name="twitter:description" content="是什么 Hibernate是一种ORM(Object Relational Mapping ）框架 它对JDBC进行了非常轻量级的对象封装  hibernate可以自动生成SQL语句，自动执行，使得Java程序员可以随心所欲的使用对象编程思维来操纵数据库">
<meta name="twitter:image" content="https://chsobin.github.io/2019/04/01/Hibernate学习笔记/log4j.png">
    
        <link rel="alternate" type="application/atom+xml" title="chsobin&#39;s blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/avatar.jpg">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">陈松彬</h5>
          <a href="mailto:1748681439@qq.com" title="1748681439@qq.com" class="mail">1748681439@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/">
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives">
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags">
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories">
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/chsobin/" target="_blank">
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.cnblogs.com/chsobin/">
                <i class="icon icon-lg icon-link"></i>
                我的博客园
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Hibernate学习笔记</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Hibernate学习笔记</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-04-01T15:52:36.000Z" itemprop="datePublished" class="page-time">
  2019-04-01
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/学习笔记/">学习笔记</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#是什么"><span class="post-toc-number">1.</span> <span class="post-toc-text">是什么</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#为什么要用"><span class="post-toc-number">2.</span> <span class="post-toc-text">为什么要用</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#快速上手"><span class="post-toc-number">3.</span> <span class="post-toc-text">快速上手</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#映射的配置"><span class="post-toc-number">4.</span> <span class="post-toc-text">映射的配置</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#核心配置"><span class="post-toc-number">5.</span> <span class="post-toc-text">核心配置</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#常用API"><span class="post-toc-number">6.</span> <span class="post-toc-text">常用API</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#主键生成策略"><span class="post-toc-number">7.</span> <span class="post-toc-text">主键生成策略</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#持久化类的三种状态"><span class="post-toc-number">8.</span> <span class="post-toc-text">持久化类的三种状态</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#一级缓存"><span class="post-toc-number">9.</span> <span class="post-toc-text">一级缓存</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#事务"><span class="post-toc-number">10.</span> <span class="post-toc-text">事务</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#事务的四个特性"><span class="post-toc-number">10.1.</span> <span class="post-toc-text">事务的四个特性</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#并发事务会产生的问题"><span class="post-toc-number">10.2.</span> <span class="post-toc-text">并发事务会产生的问题</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#隔离级别"><span class="post-toc-number">10.3.</span> <span class="post-toc-text">隔离级别</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#隔离级别与并发问题"><span class="post-toc-number">10.4.</span> <span class="post-toc-text">隔离级别与并发问题</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Hibernate-一对多关系"><span class="post-toc-number">11.</span> <span class="post-toc-text">Hibernate 一对多关系</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#一对多级联操作"><span class="post-toc-number">12.</span> <span class="post-toc-text">一对多级联操作</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#什么叫级联："><span class="post-toc-number">12.1.</span> <span class="post-toc-text">什么叫级联：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#级联是有方向性"><span class="post-toc-number">12.2.</span> <span class="post-toc-text">级联是有方向性</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#级联保存或者更新"><span class="post-toc-number">12.3.</span> <span class="post-toc-text">级联保存或者更新</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#级联删除"><span class="post-toc-number">12.4.</span> <span class="post-toc-text">级联删除</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Hibernate学习笔记" class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Hibernate学习笔记</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-04-01 23:52:36" datetime="2019-04-01T15:52:36.000Z" itemprop="datePublished">2019-04-01</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/学习笔记/">学习笔记</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style="display:none">
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h2><ul>
<li>Hibernate是一种ORM(Object Relational Mapping ）框架</li>
<li>它对JDBC进行了非常轻量级的对象封装 </li>
<li>hibernate可以自动生成SQL语句，自动执行，使得Java程序员可以随心所欲的使用对象编程思维来操纵数据库 </li>
</ul>
<a id="more"></a>
<h2 id="为什么要用"><a href="#为什么要用" class="headerlink" title="为什么要用"></a>为什么要用</h2><ul>
<li>传统基于JDBC的开发，代码重复性过多</li>
<li>使用Hibernate框架，简化了Dao层的编码工作，不用我们写很多繁琐的SQL语句</li>
</ul>
<h2 id="快速上手"><a href="#快速上手" class="headerlink" title="快速上手"></a>快速上手</h2><p>注意：此案例基于hibernate-release-5.0.7.Final</p>
<p><strong>（1）下载Hibernate 开发环境，解压后有三个主要文件夹</strong></p>
<ul>
<li>documentation          :Hibernate开发的文档</li>
<li>lib                                  :Hibernate开发包<ul>
<li>required                       :Hibernate开发的必须的依赖</li>
<li>optional                         :Hibernate开发的可选的jar包</li>
</ul>
</li>
<li>project                          :Hibernate提供的项目</li>
</ul>
<p><strong>（2）创建一个项目，引入jar包</strong></p>
<ul>
<li>数据库驱动包  mysql-connector-java-5.1.7-bin.jar</li>
<li>Hibernate开发的必须的jar包。  步骤1中required中所有的包</li>
<li>日志记录包<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="log4j.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></li>
</ul>
<p><strong>（3）创建表</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`cst_customer`</span> (</span><br><span class="line">  <span class="string">`cust_id`</span> <span class="built_in">bigint</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'客户编号(主键)'</span>,</span><br><span class="line">  <span class="string">`cust_name`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'客户名称(公司名称)'</span>,</span><br><span class="line">  <span class="string">`cust_source`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'客户信息来源'</span>,</span><br><span class="line">  <span class="string">`cust_industry`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'客户所属行业'</span>,</span><br><span class="line">  <span class="string">`cust_level`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'客户级别'</span>,</span><br><span class="line">  <span class="string">`cust_phone`</span> <span class="built_in">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'固定电话'</span>,</span><br><span class="line">  <span class="string">`cust_mobile`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'移动电话'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`cust_id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
<p><strong>（4）创建实体类</strong></p>
<p>​    com.example.hibernate.demo1.Customer.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Long cust_id;</span><br><span class="line">	<span class="keyword">private</span> String cust_name;</span><br><span class="line">	<span class="keyword">private</span> String cust_source;</span><br><span class="line">	<span class="keyword">private</span> String cust_industry;</span><br><span class="line">	<span class="keyword">private</span> String cust_level;</span><br><span class="line">	<span class="keyword">private</span> String cust_phone;</span><br><span class="line">	<span class="keyword">private</span> String cust_mobile;</span><br><span class="line">	<span class="comment">// 省略getter setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>（5）创建实体类Customer 与表cst_customer的映射</strong></p>
<p>src/com/example/hibernate/demo1/Customer.hbm.xml</p>
<p>命名格式一般为：类名.hbm.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE hibernate-mapping PUBLIC </span></span><br><span class="line"><span class="meta">    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span><br><span class="line"><span class="meta">    "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 建立类与表的映射 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"com.example.hibernate.demo1.Customer"</span> <span class="attr">table</span>=<span class="string">"cst_customer"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 建立类中的属性与表中的主键对应 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"cust_id"</span> <span class="attr">column</span>=<span class="string">"cust_id"</span> &gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- 建立类中的普通的属性和表的字段的对应 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cust_name"</span> <span class="attr">column</span>=<span class="string">"cust_name"</span> <span class="attr">length</span>=<span class="string">"32"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cust_source"</span> <span class="attr">column</span>=<span class="string">"cust_source"</span> <span class="attr">length</span>=<span class="string">"32"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cust_industry"</span> <span class="attr">column</span>=<span class="string">"cust_industry"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cust_level"</span> <span class="attr">column</span>=<span class="string">"cust_level"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cust_phone"</span> <span class="attr">column</span>=<span class="string">"cust_phone"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cust_mobile"</span> <span class="attr">column</span>=<span class="string">"cust_mobile"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><em>注意：</em></p>
<p><em>(1)该配置文件的DTD 在hibernate-core-5.0.7.Final.jar包下的/org/hibernate/hibernate-mapping-3.0.dtd</em></p>
<p><em>(2)在eclipse中设置xml自动提示，需要告诉eclipse相应的DTD文件位置具体设置可以自行百度</em></p>
<p><strong>（6）创建Hibernate的核心配置文件</strong></p>
<ul>
<li>Hibernate的核心配置文件的名称：hibernate.cfg.xml</li>
<li>放置在src目录下</li>
<li>该配置文件的DTD 在hibernate-core-5.0.7.Final.jar包下的/org/hibernate/hibernate-configuration-3.0.dtd</li>
<li>具体怎么写可以参考步骤1中project文件夹下的/etc/hibernate.properties</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE hibernate-configuration PUBLIC</span></span><br><span class="line"><span class="meta">	"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span><br><span class="line"><span class="meta">	"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 连接数据库的基本参数 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql:///hibernate<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.password"</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 配置Hibernate的方言 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- 可选配置================ --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 打印SQL --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 格式化SQL ，使得打印出来的SQL语句更加美观--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.format_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">         <span class="comment">&lt;!-- 映射文件 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/example/hibernate/demo1/Customer.hbm.xml"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>（7）编写测试代码</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Example</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="comment">// 保存客户的案例</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">// 1.加载Hibernate的核心配置文件</span></span><br><span class="line">		Configuration configuration = <span class="keyword">new</span> Configuration().configure();</span><br><span class="line">		<span class="comment">// 手动加载映射</span></span><br><span class="line">		<span class="comment">// configuration.addResource("com/example/hibernate/demo1/Customer.hbm.xml");</span></span><br><span class="line">		<span class="comment">// 2.创建一个SessionFactory对象：类似于JDBC中连接池 	</span></span><br><span class="line">		SessionFactory sessionFactory = configuration.buildSessionFactory();</span><br><span class="line">		<span class="comment">// 3.通过SessionFactory获取到Session对象：类似于JDBC中Connection</span></span><br><span class="line">		Session session = sessionFactory.openSession();</span><br><span class="line">		<span class="comment">// 4.手动开启事务：</span></span><br><span class="line">		Transaction transaction = session.beginTransaction();</span><br><span class="line">		<span class="comment">// 5.编写代码</span></span><br><span class="line">		</span><br><span class="line">		Customer customer = <span class="keyword">new</span> Customer();</span><br><span class="line">		customer.setCust_name(<span class="string">"王西"</span>);</span><br><span class="line">		</span><br><span class="line">		session.save(customer);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 6.事务提交</span></span><br><span class="line">		transaction.commit();</span><br><span class="line">		<span class="comment">// 7.资源释放</span></span><br><span class="line">		session.close();</span><br><span class="line">		sessionFactory.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="映射的配置"><a href="#映射的配置" class="headerlink" title="映射的配置"></a>映射的配置</h2><ul>
<li><p>【class标签的配置】建立类与表的映射关系</p>
<p>属性：</p>
<ul>
<li>name                ：类的全路径</li>
<li>table                 ：表名（类名与表名一致，table可以省略）</li>
<li>catalog              ：数据库名</li>
</ul>
</li>
<li><p>【id标签的配置】类中的属性与表中的主键的对应关系</p>
<p>属性：</p>
<ul>
<li>name                ：类中的属性名</li>
<li>column             ：表中的字段名（类中的属性名和表中的字段名如果一致，column可以省略）</li>
<li>length               ：长度</li>
<li>type                  ：类型</li>
</ul>
</li>
<li><p>【property标签的配置】类中的普通属性与表的字段的对应关系</p>
<p> 属性：</p>
<ul>
<li>name                ：类中的属性名</li>
<li>column              ：表中的字段名</li>
<li>length               ：长度</li>
<li>type                   ：类型</li>
<li>not-null             ：设置非空</li>
<li>unique              ：设置唯一</li>
</ul>
</li>
</ul>
<h2 id="核心配置"><a href="#核心配置" class="headerlink" title="核心配置"></a>核心配置</h2><figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 加载Hibernate的核心配置文件</span></span><br><span class="line">Configuration configuration = <span class="keyword">new</span> <span class="type">Configuration</span>().configure();</span><br><span class="line"><span class="comment">// 该语句默认会到src/hibernate.cfg.xml加载核心配置文件</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>必须的配置</p>
<ul>
<li>连接数据库的基本的参数<ul>
<li>驱动类</li>
<li>url路径</li>
<li>用户名 </li>
<li>密码</li>
<li>方言</li>
</ul>
</li>
</ul>
</li>
<li><p>可选的配置</p>
<ul>
<li>显示SQL         ：hibernate.show_sql</li>
<li>格式化SQL     ：hibernate.format_sql</li>
<li>自动建表        ：hibernate.hbm2ddl.auto<ul>
<li>none                 ：不使用hibernate的自动建表</li>
<li>create               ：如果数据库中已经有表，<strong>删除原有表</strong>，重新创建，如果没有表，新建表。（测试）</li>
<li>create-drop     ：如果数据库中已经有表，<strong>删除原有表，执行操作，删除这个表</strong>。如果没有表，新建一个，使用完了删除该表。（测试）</li>
<li>update             ：如果数据库中有表，使用原有表，如果没有表，创建新表（<strong>更新表结构</strong>）</li>
<li>validate            ：如果没有表，不会创建表。只会使用数据库中原有的表。（校验映射和表结构）。</li>
</ul>
</li>
</ul>
</li>
<li><p>映射文件的引入     </p>
<p>引入映射文件的位置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/example/hibernate/demo1/Customer.hbm.xml"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>例子：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE hibernate-configuration PUBLIC</span></span><br><span class="line"><span class="meta">	"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span><br><span class="line"><span class="meta">	"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 连接数据库的基本参数 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql:///hibernate<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.password"</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 配置Hibernate的方言 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- 可选配置================ --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 打印SQL --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 格式化SQL ，使得打印出来的SQL语句更加美观--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.format_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.format_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">         <span class="comment">&lt;!-- 自动创建表 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">         <span class="comment">&lt;!-- 映射文件 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/example/hibernate/demo1/Customer.hbm.xml"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="常用API"><a href="#常用API" class="headerlink" title="常用API"></a>常用API</h2><ul>
<li><p>Configuration</p>
<ul>
<li>用来加载配置文件</li>
</ul>
</li>
<li><p>SessionFactory</p>
<ul>
<li>用来创建Session</li>
<li>内部维护连接池</li>
<li>比较重量级，一般一个应用只创建一个对象</li>
<li>线程安全</li>
</ul>
</li>
<li><p>Session</p>
<ul>
<li>与数据库进行交互</li>
<li>线程不安全</li>
</ul>
</li>
<li><p>Transaction</p>
<p>​    事务commit()  rollback()</p>
</li>
</ul>
<h2 id="主键生成策略"><a href="#主键生成策略" class="headerlink" title="主键生成策略"></a>主键生成策略</h2><ul>
<li><p>主键的分类</p>
<ul>
<li><p>自然主键：主键本身就是表中的一个字段</p>
<p>eg:学生表中，学号就是自然属性</p>
</li>
<li><p>代理主键：不是表的字段，比如设置一个自增长的id字段</p>
<p><strong>尽量使用代理主键</strong></p>
</li>
</ul>
</li>
<li><p><strong>hibernate主键生成策略</strong></p>
<ul>
<li><strong>increment</strong> :hibernate中提供的自动增长机制<ul>
<li>实现原理，首先发送一条语句select max(id) from 表，然后以id+1作为下一条记录的主键</li>
<li>线程不安全，原因见实现原理</li>
</ul>
</li>
<li><strong>indentity</strong> 使用数据库底层的自动增长机制<ul>
<li><em>Oracle不支持自动增长机制</em></li>
</ul>
</li>
<li><strong>sequence</strong> 采用序列的方式<ul>
<li><em>Oracle支持，但MySQL不支持</em></li>
</ul>
</li>
<li><strong>uuid</strong> 适用于字符串类型的主键<ul>
<li><em>与上述三种进行区分，上述increment ，indentity ，sequence适用于short,int,long类型的主键</em></li>
</ul>
</li>
<li><strong>native</strong> 会根据底层数据库自动选择identity 或者 sequence</li>
<li><strong>assigened</strong> 该生成策略的主键值来自程序员手工设置，即通过setId()方法设置。属性类型可以是String、Int，但一般为String。此生成策略用于业务相关主键。例如学号、身份证号做主键</li>
</ul>
</li>
</ul>
<h2 id="持久化类的三种状态"><a href="#持久化类的三种状态" class="headerlink" title="持久化类的三种状态"></a>持久化类的三种状态</h2><ul>
<li>瞬时态（transient）没有唯一的标识OID,没有被session管理</li>
<li>持久态（persister）有唯一标识OID,被session管理</li>
<li>托管态（detached）有唯一标识OID,没有被session管理</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo1</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Session session = HibernateUtil.openSession();<span class="comment">// 自定义工具类</span></span><br><span class="line">		Transaction transaction = session.beginTransaction();</span><br><span class="line">		</span><br><span class="line">		Customer customer = <span class="keyword">new</span> Customer();	<span class="comment">// 瞬时态对象</span></span><br><span class="line">		customer.setCust_name(<span class="string">"小明"</span>);</span><br><span class="line">		</span><br><span class="line">		session.save(customer); <span class="comment">// 持久态对象 </span></span><br><span class="line">		customer.setCust_mobile(<span class="string">"110"</span>); <span class="comment">// 持久态对象，对customer的更改会同时更改数据库</span></span><br><span class="line">		</span><br><span class="line">		transaction.commit();</span><br><span class="line">		session.close();</span><br><span class="line">		</span><br><span class="line">		System.out.println(customer); <span class="comment">// 脱管态对象 </span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="Hiberbate持久化类三种状态转换图.gif" alt title>
                </div>
                <div class="image-caption"></div>
            </figure>
<h2 id="一级缓存"><a href="#一级缓存" class="headerlink" title="一级缓存"></a>一级缓存</h2><ul>
<li><p>为了减少与数据库交互的次数，session内部维护了一个缓存</p>
</li>
<li><p>所有对javabean的更改，不会立即发送sql语句到数据库，而是先更改一级缓存</p>
</li>
<li><p>跟session一样的生命周期</p>
<p><img src="hibernate_cache.jpg" alt>———-</p>
</li>
</ul>
<h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><ul>
<li><h3 id="事务的四个特性"><a href="#事务的四个特性" class="headerlink" title="事务的四个特性"></a>事务的四个特性</h3><ul>
<li><p><strong>原子性（Atomicity）</strong>：事务作为一个整体被执行，包含在其中的对数据库的操作要么全部被执行，要么都不执行。</p>
</li>
<li><p><strong>一致性（Consistency）</strong>：保证事务只能把数据库从一个有效（正确）的状态“转移”到另一个有效（正确）的状态 </p>
<blockquote>
<p><em>那么，什么是数据库的有效(正确）的状态？满足给这个数据库pred-defined的一些规则的状态都是 valid 的。这些规则有哪些呢，比如说constraints, cascade,triggers及它们的组合等。具体到某个表的某个字段，比如你在定义表的时候，给这个字段的类型是number类型，并且它的值不能小于0，那么你在某个 transaction 中给这个字段插入（更改）为一个 String 值或者是负值是不可以的，这不是一个“合法”的transaction，也就是说它不满足我们给数据库定义的一些规则（约束条件）。</em></p>
</blockquote>
</li>
<li><p><strong>隔离性（Isolation）</strong>：多个事务并发执行时，一个事务的执行不应影响其他事务的执行。</p>
</li>
<li><p><strong>持久性（Durability）</strong>：已被提交的事务对数据库的修改应该永久保存在数据库中。</p>
</li>
</ul>
</li>
<li><h3 id="并发事务会产生的问题"><a href="#并发事务会产生的问题" class="headerlink" title="并发事务会产生的问题"></a>并发事务会产生的问题</h3><ul>
<li><p><strong>丢失更新</strong></p>
<ul>
<li><p>第一类丢失更新 </p>
<p>​    定义：A事务撤销时，把已经提交的B事务的更新数据覆盖了。</p>
</li>
<li><p>第二类丢失更新</p>
<p>​    定义： A事务提交时，把已经提交的B事务的更新数据覆盖了。<em>（属于不可重复读的一个特例）</em></p>
</li>
</ul>
</li>
<li><p><strong>脏读</strong>：读到未提交更新的数据 </p>
</li>
<li><p><strong>不可重复读</strong>：读到已经提交更新的数据，但一个事务范围内两个相同的查询却返回了不同数据。 </p>
</li>
<li><p><strong>幻读</strong>：读到已提交插入数据，幻读与不可重复读类似，幻读是查询到了另一个事务已提交的新插入数据，而不可重复读是查询到了另一个事务已提交的更新数据。 </p>
</li>
</ul>
</li>
<li><h3 id="隔离级别"><a href="#隔离级别" class="headerlink" title="隔离级别"></a>隔离级别</h3><ul>
<li>未提交读(Read Uncommitted)：允许脏读，也就是可能读取到其他会话中未提交事务修改的数据</li>
<li>提交读(Read Committed)：只能读取到已经提交的数据。Oracle等多数数据库默认都是该级别 (不重复读)</li>
<li>可重复读(Repeated Read)：可重复读。在同一个事务内的查询都是事务开始时刻一致的，InnoDB默认级别。在SQL标准中，该隔离级别消除了不可重复读，但是还存在幻象读</li>
<li>串行读(Serializable)：完全串行化的读，每次读都需要获得表级共享锁，读写相互都会阻塞</li>
</ul>
</li>
<li><h3 id="隔离级别与并发问题"><a href="#隔离级别与并发问题" class="headerlink" title="隔离级别与并发问题"></a>隔离级别与并发问题</h3><p>| 隔离级别                     | 脏读     | 不可重复读 | 幻读     |<br>| —————————- | ——– | ———- | ——– |<br>| SERIALIZABLE （串行化）      | 不会发生 | 不会发生   | 不会发生 |<br>| REPEATABLE READ（可重复读）  | 不会发生 | 不会发生   | 可能发生 |<br>| READ COMMITTED （读已提交）  | 不会发生 | 可能发生   | 可能发生 |<br>| READ UNCOMMITTED（读未提交） | 可能发生 | 可能发生   | 可能发生 |</p>
</li>
</ul>
<h2 id="Hibernate-一对多关系"><a href="#Hibernate-一对多关系" class="headerlink" title="Hibernate 一对多关系"></a>Hibernate 一对多关系</h2><p>以一个例子来说明：</p>
<p>两个实体类：一个客户可以有多个联系人</p>
<ul>
<li><p>客户表</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">// sql语句</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`cst_customer`</span> (</span><br><span class="line">  <span class="string">`cust_id`</span> <span class="built_in">bigint</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'客户编号(主键)'</span>,</span><br><span class="line">  <span class="string">`cust_name`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'客户名称(公司名称)'</span>,</span><br><span class="line">  <span class="string">`cust_source`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'客户信息来源'</span>,</span><br><span class="line">  <span class="string">`cust_industry`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'客户所属行业'</span>,</span><br><span class="line">  <span class="string">`cust_level`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'客户级别'</span>,</span><br><span class="line">  <span class="string">`cust_phone`</span> <span class="built_in">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'固定电话'</span>,</span><br><span class="line">  <span class="string">`cust_mobile`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'移动电话'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`cust_id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Customer实体类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 客户的实体</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Long cust_id;</span><br><span class="line">	<span class="keyword">private</span> String cust_name;</span><br><span class="line">	<span class="keyword">private</span> String cust_source;</span><br><span class="line">	<span class="keyword">private</span> String cust_industry;</span><br><span class="line">	<span class="keyword">private</span> String cust_level;</span><br><span class="line">	<span class="keyword">private</span> String cust_phone;</span><br><span class="line">	<span class="keyword">private</span> String cust_mobile;</span><br><span class="line">	<span class="comment">// 通过ORM方式表示：一个客户对应多个联系人。</span></span><br><span class="line">	<span class="comment">// 放置的多的一方的集合。Hibernate默认使用的是Set集合。</span></span><br><span class="line">	<span class="keyword">private</span> Set&lt;LinkMan&gt; linkMans = <span class="keyword">new</span> HashSet&lt;LinkMan&gt;();</span><br><span class="line">	<span class="comment">//省略getter,setter方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>客户表和客户类映射文件 Customer.hbm.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE hibernate-mapping PUBLIC </span></span><br><span class="line"><span class="meta">    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span><br><span class="line"><span class="meta">    "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"com.example.hibernate.domain.Customer"</span> <span class="attr">table</span>=<span class="string">"cst_customer"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 建立OID与主键映射 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"cust_id"</span> <span class="attr">column</span>=<span class="string">"cust_id"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 建立普通属性与数据库表字段映射 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cust_name"</span> <span class="attr">column</span>=<span class="string">"cust_name"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cust_source"</span> <span class="attr">column</span>=<span class="string">"cust_source"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cust_industry"</span> <span class="attr">column</span>=<span class="string">"cust_industry"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cust_level"</span> <span class="attr">column</span>=<span class="string">"cust_level"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cust_phone"</span> <span class="attr">column</span>=<span class="string">"cust_phone"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cust_mobile"</span> <span class="attr">column</span>=<span class="string">"cust_mobile"</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 配置一对多的映射：放置的多的一方的集合 --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			set标签 ：</span></span><br><span class="line"><span class="comment">				* name	：多的一方的对象集合的属性名称。</span></span><br><span class="line"><span class="comment">		--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"linkMans"</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">				 key标签</span></span><br><span class="line"><span class="comment">					* column：多的一方的外键的名称。</span></span><br><span class="line"><span class="comment">			 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"lkm_cust_id"</span>/&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">				one-to-many标签</span></span><br><span class="line"><span class="comment">					* class	:多的一方的类的全路径</span></span><br><span class="line"><span class="comment">			 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"com.example.hibernate.domain.LinkMan"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>LinkMan实体类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkMan</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Long lkm_id;</span><br><span class="line">	<span class="keyword">private</span> String lkm_name;</span><br><span class="line">	<span class="keyword">private</span> String lkm_gender;</span><br><span class="line">	<span class="keyword">private</span> String lkm_phone;</span><br><span class="line">	<span class="keyword">private</span> String lkm_mobile;</span><br><span class="line">	<span class="keyword">private</span> String lkm_email;</span><br><span class="line">	<span class="keyword">private</span> String lkm_qq;</span><br><span class="line">	<span class="keyword">private</span> String lkm_position;</span><br><span class="line">	<span class="keyword">private</span> String lkm_memo;</span><br><span class="line">	<span class="comment">// 通过ORM方式表示：一个联系人只能属于某一个客户。</span></span><br><span class="line">	<span class="comment">// 放置的是一的一方的对象。</span></span><br><span class="line">	<span class="keyword">private</span> Customer customer;</span><br><span class="line">	<span class="comment">// 省略getter,setter方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>联系人表</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`cst_linkman`</span> (</span><br><span class="line">  <span class="string">`lkm_id`</span> <span class="built_in">bigint</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'联系人编号(主键)'</span>,</span><br><span class="line">  <span class="string">`lkm_name`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'联系人姓名'</span>,</span><br><span class="line">  <span class="string">`lkm_cust_id`</span> <span class="built_in">bigint</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'客户id'</span>,</span><br><span class="line">  <span class="string">`lkm_gender`</span> <span class="built_in">char</span>(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'联系人性别'</span>,</span><br><span class="line">  <span class="string">`lkm_phone`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'联系人办公电话'</span>,</span><br><span class="line">  <span class="string">`lkm_mobile`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'联系人手机'</span>,</span><br><span class="line">  <span class="string">`lkm_email`</span> <span class="built_in">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'联系人邮箱'</span>,</span><br><span class="line">  <span class="string">`lkm_qq`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'联系人qq'</span>,</span><br><span class="line">  <span class="string">`lkm_position`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'联系人职位'</span>,</span><br><span class="line">  <span class="string">`lkm_memo`</span> <span class="built_in">varchar</span>(<span class="number">512</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'联系人备注'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`lkm_id`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`FK_cst_linkman_lkm_cust_id`</span> (<span class="string">`lkm_cust_id`</span>),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> <span class="string">`FK_cst_linkman_lkm_cust_id`</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (<span class="string">`lkm_cust_id`</span>) <span class="keyword">REFERENCES</span> <span class="string">`cst_customer`</span> (<span class="string">`cust_id`</span>) <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">NO</span> <span class="keyword">ACTION</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">NO</span> <span class="keyword">ACTION</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
</li>
<li><p>联系人表和联系人实体类映射文件</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE hibernate-mapping PUBLIC </span></span><br><span class="line"><span class="meta">    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span><br><span class="line"><span class="meta">    "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"com.example.hibernate.domain.LinkMan"</span> <span class="attr">table</span>=<span class="string">"cst_linkman"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 建立OID与主键映射 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"lkm_id"</span> <span class="attr">column</span>=<span class="string">"lkm_id"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 建立普通属性与表字段映射 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"lkm_name"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"lkm_gender"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"lkm_phone"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"lkm_mobile"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"lkm_email"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"lkm_qq"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"lkm_position"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"lkm_memo"</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 配置多对一的关系：放置的是一的一方的对象 --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			many-to-one标签</span></span><br><span class="line"><span class="comment">				* name		:一的一方的对象的属性名称。</span></span><br><span class="line"><span class="comment">				* class		:一的一方的类的全路径。</span></span><br><span class="line"><span class="comment">				* column	:在多的一方的表的外键的名称。</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">"customer"</span> <span class="attr">class</span>=<span class="string">"com.example.hibernate.domain.Customer"</span> <span class="attr">column</span>=<span class="string">"lkm_cust_id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>测试代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Session session = HibernateUtil.openSession();</span><br><span class="line">		Transaction tx = session.beginTransaction();</span><br><span class="line">		tx.begin();</span><br><span class="line"></span><br><span class="line">		Customer customer1 = <span class="keyword">new</span> Customer(); <span class="comment">// 新建一个客户对象</span></span><br><span class="line">		customer1.setCust_name(<span class="string">"客户1"</span>);</span><br><span class="line">		</span><br><span class="line">		LinkMan linkman1_1 = <span class="keyword">new</span> LinkMan();	<span class="comment">// 新建一个联系人</span></span><br><span class="line">		linkman1_1.setLkm_name(<span class="string">"联系人1，属于客户1"</span>);</span><br><span class="line">		linkman1_1.setCustomer(customer1);</span><br><span class="line">		</span><br><span class="line">		LinkMan linkMan1_2 = <span class="keyword">new</span> LinkMan();	<span class="comment">// 新建一个联系人</span></span><br><span class="line">		linkMan1_2.setLkm_name(<span class="string">"联系人2，属于客户1"</span>);</span><br><span class="line">		linkMan1_2.setCustomer(customer1);</span><br><span class="line">		</span><br><span class="line">		customer1.getLinkMans().add(linkman1_1);</span><br><span class="line">		customer1.getLinkMans().add(linkMan1_2);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 联系人和客户对象都需要保存</span></span><br><span class="line">		session.save(customer1);</span><br><span class="line">		session.save(linkman1_1);</span><br><span class="line">		session.save(linkMan1_2);</span><br><span class="line">		</span><br><span class="line">		tx.commit();</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="一对多级联操作"><a href="#一对多级联操作" class="headerlink" title="一对多级联操作"></a>一对多级联操作</h2><ul>
<li><h3 id="什么叫级联："><a href="#什么叫级联：" class="headerlink" title="什么叫级联："></a>什么叫级联：</h3><p>​    级联指的是，操作一个对象的时候，是否会同时操作其关联的对象。 </p>
</li>
<li><h3 id="级联是有方向性"><a href="#级联是有方向性" class="headerlink" title="级联是有方向性"></a>级联是有方向性</h3><ul>
<li>操作一的一方的时候，是否操作到多的一方</li>
<li>操作多的一方的时候，是否操作到一的一方</li>
</ul>
</li>
<li><h3 id="级联保存或者更新"><a href="#级联保存或者更新" class="headerlink" title="级联保存或者更新"></a>级联保存或者更新</h3><blockquote>
<p> <strong>保存客户级联联系人</strong>,需要在Customer.hbm.xml进行配置</p>
</blockquote>
<ul>
<li><p>配置映射文件Customer.hbm.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--cascade = "save-update"--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"linkMans"</span> <span class="attr">cascade</span>=<span class="string">"save-update"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"lkm_cust_id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"com.example.hibernate.domain.LinkMan"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Session session = HibernateUtil.openSession();</span><br><span class="line">    Transaction tx = session.beginTransaction();</span><br><span class="line"></span><br><span class="line">    Customer customer = <span class="keyword">new</span> Customer();</span><br><span class="line">    customer.setCust_name(<span class="string">"阿里巴巴"</span>);</span><br><span class="line"></span><br><span class="line">    LinkMan linkman1 = <span class="keyword">new</span> LinkMan();</span><br><span class="line">    linkman1.setLkm_name(<span class="string">"阿里巴巴技术总监"</span>);</span><br><span class="line"></span><br><span class="line">    LinkMan linkman2 = <span class="keyword">new</span> LinkMan();</span><br><span class="line">    linkman2.setLkm_name(<span class="string">"阿里巴巴开发组长"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 保存一边</span></span><br><span class="line">    customer.getLinkMans().add(linkman1);</span><br><span class="line">    customer.getLinkMans().add(linkman2);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 保存一边</span></span><br><span class="line">    session.save(customer);</span><br><span class="line"></span><br><span class="line">    tx.commit();</span><br><span class="line">    session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p><strong>保存联系人级联客户</strong></p>
</blockquote>
<ul>
<li><p>与上述差不多的操作</p>
</li>
<li><p>修改LinkMan.hbm.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">"customer"</span> <span class="attr">cascade</span>=<span class="string">"save-update"</span> <span class="attr">class</span>=<span class="string">"com.example.hibernate.domain.Customer"</span> <span class="attr">column</span>=<span class="string">"lkm_cust_id"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><h3 id="级联删除"><a href="#级联删除" class="headerlink" title="级联删除"></a>级联删除</h3><ul>
<li><p>级联删除：删除一边的时候，同时将另一方的数据也一并删除。</p>
</li>
<li><p>下面以一个具体的例子来说明：</p>
<blockquote>
<p>1、删除客户，级联删除联系人 </p>
</blockquote>
<ul>
<li><p>第一步，修改映射文件Customer.hbm.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"linkMans"</span> <span class="attr">cascade</span>=<span class="string">"delete"</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>第二步，编写测试代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Session session = HibernateUtil.openSession();</span><br><span class="line">    Transaction tx = session.beginTransaction();</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * (1)级联删除</span></span><br><span class="line"><span class="comment">		 * &lt;set name="linkMans" cascade="delete"&gt;</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">    Customer customer1 = session.get(Customer.class, <span class="number">1L</span>);</span><br><span class="line">    session.delete(customer1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * (2)如果没有设置cascade="delete"</span></span><br><span class="line"><span class="comment">		 * 运行下面的结果为：只删除了一的一方，多的一方不会被删除</span></span><br><span class="line"><span class="comment">		 * 但是多的一方的外键会被设置为null</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">    Customer customer2 = session.get(Customer.class, <span class="number">2L</span>);</span><br><span class="line">    session.delete(customer2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">		 *  (3)如果customer不是持久态度</span></span><br><span class="line"><span class="comment">		 *  这种方式不会删除多的一方</span></span><br><span class="line"><span class="comment">		 *  但是会把多的一方的外键设置为null</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">    Customer customer3 = <span class="keyword">new</span> Customer();</span><br><span class="line">    customer3.setCust_id(<span class="number">3L</span>);</span><br><span class="line">    session.delete(customer3);		</span><br><span class="line"></span><br><span class="line">    tx.commit();</span><br><span class="line">    session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<ol start="2">
<li>删除联系人，级联删除客户</li>
</ol>
</blockquote>
<ul>
<li><p>在一对多中一般不会出现这种情况：没有说删除多的一方，然后把一的一方删除的，因此下面只是测试使用</p>
<ul>
<li><p>第一步,修改映射文件LinkMan.hbm.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">"customer"</span> <span class="attr">cascade</span>=<span class="string">"delete"</span> <span class="attr">class</span>=<span class="string">"com.example.hibernate.domain.Customer"</span> <span class="attr">column</span>=<span class="string">"lkm_cust_id"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>第二步,编写测试代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Session session = HibernateUtil.openSession();</span><br><span class="line">    Transaction tx = session.beginTransaction();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * 删除联系人，级联删除客户</span></span><br><span class="line"><span class="comment">		 * 在多的一方设置cascade="delete"</span></span><br><span class="line"><span class="comment">		 * &lt;many-to-one name="customer" cascade="delete" class="com.example.hibernate.domain.Customer" column="lkm_cust_id"/&gt;</span></span><br><span class="line"><span class="comment">		 * </span></span><br><span class="line"><span class="comment">		 * 运行结果：</span></span><br><span class="line"><span class="comment">		 * 联系人和联系人关联的客户均被删除</span></span><br><span class="line"><span class="comment">		 * 和客户有关联的其他联系人的外键被设置为null</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">    LinkMan linkMan = session.get(LinkMan.class, <span class="number">1L</span>);</span><br><span class="line">    session.delete(linkMan);</span><br><span class="line"></span><br><span class="line">    tx.commit();</span><br><span class="line">    session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>cascade</strong> 和 <strong>inverse</strong></p>
<ul>
<li>cascade:级联<ul>
<li>save</li>
<li>update</li>
<li>save-update</li>
<li>delete</li>
</ul>
</li>
<li>inverse : 外键维护权<ul>
<li>true 放弃外键维护权</li>
<li>false 拥有外键维护权，默认值</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2019-04-01T18:28:57.053Z" itemprop="dateUpdated">2019-04-02 02:28:57</time>
</span><br>


        
        <a href="/2019/04/01/Hibernate学习笔记/" target="_blank" rel="external">https://chsobin.github.io/2019/04/01/Hibernate学习笔记/</a>
        
    </div>
    
    <footer>
        <a href="https://chsobin.github.io">
            <img src="/img/avatar.jpg" alt="陈松彬">
            陈松彬
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://chsobin.github.io/2019/04/01/Hibernate学习笔记/&title=《Hibernate学习笔记》 — chsobin's blog&pic=https://chsobin.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://chsobin.github.io/2019/04/01/Hibernate学习笔记/&title=《Hibernate学习笔记》 — chsobin's blog&source=是什么
Hibernate是一种ORM(Object Relational Mapping ）框架
它对JDBC进行了非常轻量级的对象封装 
hibern..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://chsobin.github.io/2019/04/01/Hibernate学习笔记/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Hibernate学习笔记》 — chsobin's blog&url=https://chsobin.github.io/2019/04/01/Hibernate学习笔记/&via=https://chsobin.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://chsobin.github.io/2019/04/01/Hibernate学习笔记/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2019/04/02/测试代码块缩进问题/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">测试代码块缩进问题</h4>
      </a>
    </div>
  

  
</nav>



    




















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.png" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/wechat.png" data-alipay="/img/alipay.png">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style="display:none">
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style="display:none">
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>陈松彬 &copy; 2019</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://chsobin.github.io/2019/04/01/Hibernate学习笔记/&title=《Hibernate学习笔记》 — chsobin's blog&pic=https://chsobin.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://chsobin.github.io/2019/04/01/Hibernate学习笔记/&title=《Hibernate学习笔记》 — chsobin's blog&source=是什么
Hibernate是一种ORM(Object Relational Mapping ）框架
它对JDBC进行了非常轻量级的对象封装 
hibern..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://chsobin.github.io/2019/04/01/Hibernate学习笔记/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Hibernate学习笔记》 — chsobin's blog&url=https://chsobin.github.io/2019/04/01/Hibernate学习笔记/&via=https://chsobin.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://chsobin.github.io/2019/04/01/Hibernate学习笔记/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLElEQVR42u3aS26EMBAFQO5/aSJlG8G8Zw+RsMurUQalqSw67s9xxOf8PfmTV89ffXv+OccTBwMD47WM8/a04RPG1ef7uB9+PwYGxgaMPGQS+D7JXj2TxL38OQYGBsZtwr1PjsnlDwMDA+P/GWNpOvkNGBgYOzOSdNk22vKStX0SAwNjN0Y7GPjPzw/ONzAwMF7COIdOO+ZsBw/1+2BgYCzNyEeJ3ypK22/z8hgDA2NVRtvw+u4wcqaFh4GBsTNjvqAtWvlDi2LFC2FgYCzBSJJacvmbvyzOlMQYGBi7MfJFhzaxjl1Gk5EnBgbG2ow2OebXu5yaN/WKESYGBsZCjLweLOYMQ1sQbfTBshYDA+OFjLZM/Vb4sQWOemcEAwNjCcbMkCAfPebD0bGVDgwMjB0Y+fXuueWwdtmimCRgYGAsx0gCH0NnrPVWxMXAwFiUkReu88PIvGStkzsGBsYGjDZMvniR58M8NUf1NwYGxqKMsaFj29afWbb4MMLEwMBYlJE3+pNXaccJY8m67h1iYGC8nDG/HpEMA3L8GAkDA2NtRnv9GnutdrQ504zDwMBYj3GWJ1mwmB9P5sm9rrwxMDBeyBhblWgDt6VsflnEwMDYh9EWq3nJ2ibo5MkP/UIMDIylGfNN/DYFt/8T6nksBgbGxoz5BYt2hBD9KTEwMDCGFrna9lkbBQMDYzdGW8SOpeD8tdoEjYGBsTajHQwkL5ePBx5ZDsPAwFiH8QNPlh3z0LFEOgAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
